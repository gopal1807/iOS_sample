Bug fixes and performances improvements
